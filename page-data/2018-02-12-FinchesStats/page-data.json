{"componentChunkName":"component---src-templates-blog-post-js","path":"/2018-02-12-FinchesStats/","result":{"data":{"markdownRemark":{"html":"<p>Data: Darwin's finches on Daphne Major Island.<br>\nMethods: Graphical and quantitative EDA, parameter estimation, confidence interval calculation &#x26; hypothesis testing.</p>\n<hr>\n<h2>An analysis of evolutionary data of finches scandens and fortis.</h2>\n<p>This is a my own take on a case study from a DataCamp.com course on Statistical Thinking, Part 2.<br>\nThe Jupyter notebook can be found <a href=\"https://github.com/sbhaseen/Python/blob/master/Notebook_FinchesStats/Notebook_FinchesStatsRedux.ipynb\">here</a>.</p>\n<h3>Original data publication:</h3>\n<p>Grant, PR, Grant, BR (2014) 40 years of evolution:<br>\nDarwin's finches on Daphne Major Island.<br>\nPrinceton: Princeton University Press. <a href=\"https://doi.org/\">https://doi.org/</a></p>\n<p>Dryad data package:</p>\n<p>Grant PR, Grant BR (2014) Data from: 40 years of evolution.<br>\nDarwin's finches on Daphne Major Island.<br>\nDryad Digital Repository. <a href=\"https://doi.org/10.5061/dryad.g6g3h\">https://doi.org/10.5061/dryad.g6g3h</a></p>\n<h3>Importing and cleaning data from CSV files</h3>\n<pre><code class=\"language-python\">%matplotlib inline\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfinches_1975 = pd.read_csv('datasets/finch_beaks_1975.csv',\n                           usecols=['species',\n                                    'Beak length, mm',\n                                    'Beak depth, mm'])\nfinches_1975.rename(columns={'Beak depth, mm': 'bdepth',\n                             'Beak length, mm': 'blength'}, inplace=True)\nfinches_1975['year'] = 1975\n\nfinches_2012 = pd.read_csv('datasets/finch_beaks_2012.csv',\n                           usecols=['species',\n                                    'blength',\n                                    'bdepth'])\nfinches_2012['year'] = 2012\n\nfinches = pd.concat([finches_1975, finches_2012], ignore_index=True)\n</code></pre>\n<h3>Perform an exploratory data analysis (EDA) of beak depth for G. scandens 1975 vs. 2012</h3>\n<pre><code class=\"language-python\">sns.set()  # Set Seaborn default plot style\n\n# Isolating scandens beak depth, bdepth\ny = finches.loc[finches['species'] == 'scandens', 'bdepth']\nsns.swarmplot(x='year', y=y, data=finches)\nplt.title('G. scandens Beak Depth: 1975 vs. 2012')\nplt.xlabel('Year')\nplt.ylabel('Beak depth (mm)');\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/258156adc670286e090a7d2e8845a670/6af66/FinchesStats01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACGUlEQVQ4y22UaW/TQBCG+///A58QEp8AgRAIJKqCRCkgjlCqNmlOx/d9Jr7ydma3TtZOLE08nuw+c+6e7XY7DJ+2bVHXNcqyRFVVQlhnG+sNvVkfPsw6OwAaWswLWyRJBtt2oGk61msDhmFitdLgOC5M06b/6G3Z5ISdNUK6wASQvUYRQxLalMB1U3heBs/P5FsRn2yum8CwA7GuW9+2CrCuK8RxTsAYLi2wnRiWFdPivrDddVIsdAtz3YTnZtJ2DKwPQPKuGxEmM5ciSoWNo3AeHTHkfq3jdrUU8G7PHsiwoij2KXvkjYF3UwnsYFJiBF6O68UUv6a38AnuDCOMogh5niFNNyJNnyCrdYgvP5cngLJeH/9f4t2/zyJiaVMiDMOQuhqTFCJ8hkzmLj5dzWE9pqPCTDvEi98f8PT7K8xoArgEPWAQBFS/SAAZwBGeXy3w5OVf3M898W0rEbLTN6NzPPvxGprpiTr2gHmeY7MpJJBSDmgsbia2AHLqw7Rlyl/xdnRBAUTHKfNP0zSiKRwhA6/HNp6/vxEO1JS5ZpG/wbfJCJfjEULSZZcHY6MOttoUFdbv8gx/ZnekF8dzyCdmt2tFyqYZiU0cmW7E+5p1J0gOfoql4WCsafAcysqSaStAqfAZLoqS6lnRGG1po9/7TtNC6NttjSCg5vmh0NnG0jvLp24c9TapqpImIT7cKnSZtG1z8rZ5AGVfdELC8LxuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"finch beak depth\"\n        title=\"finch beak depth\"\n        src=\"/static/258156adc670286e090a7d2e8845a670/6af66/FinchesStats01.png\"\n        srcset=\"/static/258156adc670286e090a7d2e8845a670/4edbd/FinchesStats01.png 175w,\n/static/258156adc670286e090a7d2e8845a670/13ae7/FinchesStats01.png 350w,\n/static/258156adc670286e090a7d2e8845a670/6af66/FinchesStats01.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Functions to help the analysis</h3>\n<pre><code class=\"language-python\"># Function definitions\n\n\ndef ecdf(data):\n    \"\"\"\n    Compute the empirical cumulative distribution function (ECDF)\n    for a one-dimensional array of data.\n    Params: data\n    \"\"\"\n\n    n = len(data)  # Number of data points\n    x = np.sort(data)\n    y = np.arange(1, n+1) / n\n\n    return x, y\n\n\ndef draw_bs_reps(data, func, size=1):\n    \"\"\"\n    Draw bootstrap replicates for a given size and apply Numpy functions.\n    Params: data, func, size\n    \"\"\"\n\n    bs_replicates = np.empty(size)\n\n    for i in range(size):\n        bs_replicates[i] = func(np.random.choice(data, size=len(data)))\n\n    return bs_replicates\n\n\ndef draw_bs_pairs_linreg(x, y, size=1):\n    \"\"\"\n    Perform pairs bootstrap for linear regression.\n    Params: x-data, y-data, size\n    \"\"\"\n\n    # Set up array of indices to sample from: inds\n    inds = np.arange(len(x))\n\n    # Initialize replicates\n    bs_slope_reps = np.empty(size)\n    bs_intercept_reps = np.empty(size)\n\n    # Generate replicates\n    for i in range(size):\n        bs_inds = np.random.choice(inds, size=len(inds))\n        bs_x, bs_y = x[bs_inds], y[bs_inds]\n        bs_slope_reps[i], bs_intercept_reps[i] = np.polyfit(bs_x, bs_y, 1)\n\n    return bs_slope_reps, bs_intercept_reps\n</code></pre>\n<p>Here, I compute and plot the emperical cumulative distribution fuction (ECFD) of G. scandens beak measurements.<br>\nThis gives an overview of the data so I can pick out some features and trends.</p>\n<pre><code class=\"language-python\"># Convert dataframes data to arrays for computation\nbd_1975 = np.array(finches.loc[(finches['species'] == 'scandens') &#x26;\n                               (finches['year'] == 1975),\n                               'bdepth'])\nbd_2012 = np.array(finches.loc[(finches['species'] == 'scandens') &#x26;\n                               (finches['year'] == 2012),\n                               'bdepth'])\nx_1975, y_1975 = ecdf(bd_1975)\nx_2012, y_2012 = ecdf(bd_2012)\n\nplt.plot(x_1975, y_1975, marker='.', linestyle='none')\nplt.plot(x_2012, y_2012, marker='.', linestyle='none')\nplt.margins(0.02)\nplt.title('ECDF of G. scandens Beak Depth: 1975 vs. 2012')\nplt.ylabel('ECDF')\nplt.legend(('1975', '2012'), loc='lower right');\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3d898952032694ebadb2b855bd6fd31d/6af66/FinchesStats02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAB+UlEQVQ4y22UiW6jMBCG8/4vV2mrbpqQNOUGgwFzhHCEf2dMzAItkjU+f39zmMM0TVh/z+eIvu8wDD3GcUDXdTTuX43nB93ntZH664+1DtwZx5EO8qYJeV7A8wLEcYIkkXAcV499P6S+ByESRKEgm8IPQjwefOEAA3aYqZ4oyzuJKKRpBSlr3ZKkQpY1NFcjJ5skNYKwhBtKfHkxvEgijHOIRJHGS3BWnlBVLaJI0aFSCwsx21jMc0GgcLoKfNxsOIGgtUJfaCA2hBybPK+0CB+e7TzmzUGocLxGOLsu/DiFTIl2tXcjaDp1/SDCYiFjK8hG1D6tBJ/OTJaS20y99oIv3xB23eMXwpJIKtycDOdbjJNnL9S/ebEIcpayTKJtB4RhsWw27a8lcLRtSgRlXVSazqyZeG8EOcNVVUIpciX+f3smK1xuEn+u37DDCBnFTYvsvPhBaIrSZNlsdL0CHxcfR+cGmbCY2pCvCX/EkAtbqWbBZ9L3c6ATwXXGB9ah2BNyze4Ke0RJgiJmV2u8nWy8f33rA/tE7BtXBtfkj7JR9FIcP8HFCWHZwUJqinfr6jwXkz1bLizL2b5l/gHU9wZZQfiZwtA/qYwUvdNe27bt6Wk2FOc7mqZd5qTMcb8/9Hh4/SgO+7+NGXMY1naanjDP1Mxx7LdrwD8gTHrmU+7S/wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Emperical Cumulative Distribution Fuction plot\"\n        title=\"Emperical Cumulative Distribution Fuction plot\"\n        src=\"/static/3d898952032694ebadb2b855bd6fd31d/6af66/FinchesStats02.png\"\n        srcset=\"/static/3d898952032694ebadb2b855bd6fd31d/4edbd/FinchesStats02.png 175w,\n/static/3d898952032694ebadb2b855bd6fd31d/13ae7/FinchesStats02.png 350w,\n/static/3d898952032694ebadb2b855bd6fd31d/6af66/FinchesStats02.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Parameter estimation of the mean difference between 1975 and 2012 data.</h3>\n<p>A random seed value of seed(42) is used for reproducibility.<br>\nFor bootstrap data, a sample of 10,000 tries is used.<br>\nThe results are then compared to the 95% confidence interval.</p>\n<pre><code class=\"language-python\">np.random.seed(42)\n\nmean_diff = np.mean(bd_2012) - np.mean(bd_1975)\n\nbs_replicates_1975 = draw_bs_reps(bd_1975, np.mean, 10000)\nbs_replicates_2012 = draw_bs_reps(bd_2012, np.mean, 10000)\n\nbs_diff_replicates = bs_replicates_2012 - bs_replicates_1975\nconf_int = np.percentile(bs_diff_replicates, [2.5, 97.5])\n\nprint('Difference of means =', mean_diff, 'mm')\nprint('95% confidence interval =', conf_int, 'mm')\n</code></pre>\n<pre><code class=\"language-shell\">Difference of means = 0.226220472441 mm\n95% confidence interval = [ 0.05633521  0.39190544] mm\n</code></pre>\n<p>A result of 0.2 mm difference between the means of 2012 and 1975 is observed.<br>\nThis result lies between the 95% confidence interval of 0.05 to 0.38 mm.</p>\n<h2>Hypothesis test: Are beaks deeper in 2012?</h2>\n<h3>Null hypothesis: The means of 2012 and 1975 are equal.</h3>\n<p>-Is this observation just due to random chance<br>\n-What is the probability that one would observe the same or greater difference\nin mean beak depth if the means were the same (p-value)</p>\n<p>To perform this hypothesis test, the two data sets are shifted such that they have the same mean.\nFollowing that, a bootstrap sampling method of 10,000 samples is used to compute a new random difference of means.</p>\n<pre><code class=\"language-python\">combined_mean = np.mean(np.concatenate((bd_1975, bd_2012)))\n\nbd_1975_shifted = bd_1975 - np.mean(bd_1975) + combined_mean\nbd_2012_shifted = bd_2012 - np.mean(bd_2012) + combined_mean\n\nbs_replicates_1975 = draw_bs_reps(bd_1975_shifted, np.mean, 10000)\nbs_replicates_2012 = draw_bs_reps(bd_2012_shifted, np.mean, 10000)\n\nbs_diff_replicates = bs_replicates_2012 - bs_replicates_1975\n\np = np.sum(bs_diff_replicates >= mean_diff) / len(bs_diff_replicates)\n\nprint('P-value of hypothesis test: p =', p)\n</code></pre>\n<pre><code class=\"language-shell\">P-value of hypothesis test: p = 0.0037\n</code></pre>\n<p>A p-value of 0.0037 is calculated, which suggests that there is a\nstatistically significant difference and the null hypotheses can be rejected.<br>\nCombining this with the difference of 0.2 mm between the means suggest\na change by 0.2 mm in 37 years (1975 to 2012).</p>\n<h2>EDA of beak length and depth</h2>\n<p>The beak length and depth are compared to determine if there exists a correlation.</p>\n<pre><code class=\"language-python\"># Extracting beak length (blength) from original Data Frame\nbl_1975 = np.array(finches.loc[(finches['species'] == 'scandens') &#x26;\n                               (finches['year'] == 1975),\n                               'blength'])\nbl_2012 = np.array(finches.loc[(finches['species'] == 'scandens') &#x26;\n                               (finches['year'] == 2012),\n                               'blength'])\n\n# Make scatter plots of 1975 &#x26; 2012 data\n\nplt.plot(bl_1975, bd_1975, marker='.',\n         linestyle='none', color='blue', alpha=0.5)\n\nplt.plot(bl_2012, bd_2012, marker='.',\n         linestyle='none', color='red', alpha=0.5)\n\nplt.title('Beak Depth vs. Beak Length G. scandens: 1975 &#x26; 2012')\nplt.xlabel('Beak length (mm)')\nplt.ylabel('Beak depth (mm)')\nplt.legend(('1975', '2012'), loc='upper left');\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be3012bda1ca0f09832401852efb5de1/6af66/FinchesStats03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACEUlEQVQ4y22Uh27rMAxF+/9fWBQvTeKpYdmSZ+J1H0nbGW0NEKIo6YhD9Me6rji+dV0wjqPING0yjncaJ4wyn3C/7/N93zzPL+dXfLDCxnle0DQ9LpcIUZRAa4s810iSFGmaI88UDNl4zZgCShmxF4WjC2YcjgmQb/e+pUMen59ngnk419LmVkZbNCgsCY9ib+BYp3W725flFUiuh9BCK0+3FuRB2KWGsSSadLJbukhsvKa3da3r38B5ngjY0WKQGy1D+CABLNl0XsFmJY1BALzOI4tStZx5ADnBfd9LyLyBQQeQYTZ1UAwxm24oCoHlm7cMdO4F6L1H17VUkGH38AkUaOZgEwt7yWHOSgB5FpDE4eHhW8hVVaGuA0n/BNIGyREnnID6Xwr1lSL/yqATJ5Asqx95NKZ5VrksS8qffwdSWCYpUEQa9pwhiyvkicf3qUZ6LZGcLK7XRorIwDcPu67DMPQbUAWBbVJBnc0maYn45BBdA1RCxaG5RLGn5Y8qz4+iSJXZ05gebuyRnQyy1EvOkmhLQ66aR0H+BPI7FKDZq0lPhN+cih2FWiGNPHXNfpl5fwm/gJxLTmgdeqpetb+/IHDuHIY/D7aS5+O9HvoP4KZwPw7DiLYdKJ8dbrcJXX9D6bz0OHeSc5Xs6fs7zRvRh2HTl2V5hvz6x6HZ27zy1CXWiBSFla46/kyvf6njzH8GGnoVWsG1hQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Beak depth vs length\"\n        title=\"Beak depth vs length\"\n        src=\"/static/be3012bda1ca0f09832401852efb5de1/6af66/FinchesStats03.png\"\n        srcset=\"/static/be3012bda1ca0f09832401852efb5de1/4edbd/FinchesStats03.png 175w,\n/static/be3012bda1ca0f09832401852efb5de1/13ae7/FinchesStats03.png 350w,\n/static/be3012bda1ca0f09832401852efb5de1/6af66/FinchesStats03.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>From the plot, we see that beaks got deeper but not much longer.</p>\n<h2>Perform a linear regression of the beak length and depth</h2>\n<p>First, the linear regressions of 1975 and 2012 data are computed.\nThen a paris bootstrap sampling of 1000 linear gresressions is perfromed.\nFollowing that, the 95% confidence interval of the bootstrap linear regression solpes and intercepts are dertermined.</p>\n<pre><code class=\"language-python\">slope_1975, intercept_1975 = np.polyfit(bl_1975, bd_1975, 1)\nslope_2012, intercept_2012 = np.polyfit(bl_2012, bd_2012, 1)\n\nbs_slope_reps_1975, bs_intercept_reps_1975 = \\\n        draw_bs_pairs_linreg(bl_1975, bd_1975, 1000)\nbs_slope_reps_2012, bs_intercept_reps_2012 = \\\n        draw_bs_pairs_linreg(bl_2012, bd_2012, 1000)\n\nslope_conf_int_1975 = np.percentile(bs_slope_reps_1975, [2.5, 97.5])\nslope_conf_int_2012 = np.percentile(bs_slope_reps_2012, [2.5, 97.5])\nintercept_conf_int_1975 = np.percentile(bs_intercept_reps_1975, [2.5, 97.5])\nintercept_conf_int_2012 = np.percentile(bs_intercept_reps_2012, [2.5, 97.5])\n\nprint('1975: slope =', slope_1975,\n      '95% conf int =', slope_conf_int_1975)\nprint('1975: intercept =', intercept_1975,\n      '95% conf int =', intercept_conf_int_1975)\nprint('2012: slope =', slope_2012,\n      '95% conf int =', slope_conf_int_2012)\nprint('2012: intercept =', intercept_2012,\n      '95% conf int =', intercept_conf_int_2012)\n</code></pre>\n<pre><code class=\"language-shell\">1975: slope = 0.465205169161 95% conf int = [ 0.32895048  0.59051248]\n1975: intercept = 2.39087523658 95% conf int = [ 0.56980654  4.32921979]\n2012: slope = 0.462630358835 95% conf int = [ 0.33013404  0.5971864 ]\n2012: intercept = 2.97724749824 95% conf int = [ 1.15904983  4.74841692]\n</code></pre>\n<p>The linear regression data is then plotted.</p>\n<pre><code class=\"language-python\">plt.plot(bl_1975, bd_1975, marker='.',\n         linestyle='none', color='blue', alpha=0.5)\n\nplt.plot(bl_2012, bd_2012, marker='.',\n         linestyle='none', color='red', alpha=0.5)\n\nplt.title('Linear regressions of G. scandens beak depth vs length')\nplt.xlabel('beak length (mm)')\nplt.ylabel('beak depth (mm)')\nplt.legend(('1975', '2012'), loc='upper left')\n\n# Generate x-values for bootstrap line plots\nx = np.array([10, 17])\n\n# Plot the bootstrap lines\nfor i in range(100):\n    plt.plot(x, bs_slope_reps_1975[i] * x + bs_intercept_reps_1975[i],\n             linewidth=0.5, alpha=0.2, color='blue')\n    plt.plot(x, bs_slope_reps_2012[i] * x + bs_intercept_reps_2012[i],\n             linewidth=0.5, alpha=0.2, color='red')\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d6d12135663f71209cd23a225ad17c39/6af66/FinchesStats04.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA9hAAAPYQGoP6dpAAACd0lEQVQ4y21U/W/TMBDtH88vTOp+QmwMCbQNKEOgSaBNKlQCNOhAgDZ10lYN9tmmSew0X85Hk7Z5nO2kpR2OTo7v7Jd3d8+pgUZRFIB+wXg8JsuR59r0eowsy0pfVvrncXVUPnS+VoFNpwWiOEW/b8AwTNze9ul9AMYcZXI9GJgq3usZME0bBsUtmieTYkZqBhiJEQaGh7OzS1iWD8eJlHEu4Egr1zOTPjcB47SHBYqQAtTsJgjDGMz2iZ1kFJCFM5OgzPTAKc7oY4yHsL0UTs+G//UQ7vk1pmXJaihHFKWwbX2Y8wooVOCSAetx5bP8HPzagvj0Ge72Dn7W9/D71wBVL1TKaZpqhmwJiGZuumCGC6vnYtjpInrfBF/fwpf7TTxfvcTOyxAXl5HMUxJETXbPdYdIklzVTqVrB7CJqUzLHsbwT06RbD6FsbKB1soB1uoMr99mODpJqTkhho6Y11ACOg6HEDplRgAsyBQz0T6E2NzCRf0FdusneLLuYe+dQLcrEHg+PI8yoIycfwFHoxE5GZKUGJrU3fMbeB8+gm08w/HKLrbvneLRmkCzleDqjw/f9ajDVEtLl8embBYAJ+MJ4jhCKBLYzQPcPGigvdpC42EfjTc5vv8gxlcWhtxXDVNZLNR6iSHKSxJTl781Onj12MDufo6jTkK1CeB7WkI2uwv0X4Za2AXCIMFBO8ZxJ1Yy8TzdZS2lOdCy3WFY3RTZFMukr3ENZFlzccubUR2UjCpmugRLDCtBxnGitJhScwTVM00ztY4iSn3oky8mefkkr6zclyEIonJ/vCjsahTFFAt/HyqFEJKtRWy4kpf8u1Tx5f1y/gsbC2gGGyquIwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"linear regression of beak depth vs length\"\n        title=\"linear regression of beak depth vs length\"\n        src=\"/static/d6d12135663f71209cd23a225ad17c39/6af66/FinchesStats04.png\"\n        srcset=\"/static/d6d12135663f71209cd23a225ad17c39/4edbd/FinchesStats04.png 175w,\n/static/d6d12135663f71209cd23a225ad17c39/13ae7/FinchesStats04.png 350w,\n/static/d6d12135663f71209cd23a225ad17c39/6af66/FinchesStats04.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Exploring the beak length and depth ratio</h2>\n<p>The beak length and depth are copared to see how the values changed together.\nFirstly, the original data is compared, then a bootstrap sampling of 10,000 is used to determine a 99% confidence interval.</p>\n<pre><code class=\"language-python\">ratio_1975 = bl_1975 / bd_1975\nratio_2012 = bl_2012 / bd_2012\n\nmean_ratio_1975 = np.mean(ratio_1975)\nmean_ratio_2012 = np.mean(ratio_2012)\n\n# Generate bootstrap replicates of the means for 10,000 samples\nbs_replicates_1975 = draw_bs_reps(ratio_1975, np.mean, 10000)\nbs_replicates_2012 = draw_bs_reps(ratio_2012, np.mean, 10000)\n\n# Compute the 99% confidence intervals\nconf_int_1975 = np.percentile(bs_replicates_1975, [0.5, 99.5])\nconf_int_2012 = np.percentile(bs_replicates_2012, [0.5, 99.5])\n\nprint('1975: mean ratio =', mean_ratio_1975,\n      '99% conf int =', conf_int_1975)\nprint('2012: mean ratio =', mean_ratio_2012,\n      '99% conf int =', conf_int_2012)\n</code></pre>\n<pre><code class=\"language-shell\">1975: mean ratio = 1.57888237719 99% conf int = [ 1.55651998  1.60112118]\n2012: mean ratio = 1.46583422768 99% conf int = [ 1.4448795   1.48772402]\n</code></pre>\n<p>The mean beak length-to-depth ratio decreased by about 0.1 from 1975 to 2012.\nThe 99% confidence intervals are not overlapping, which indicates that the beak shape changed.</p>","frontmatter":{"date":"February 12, 2018","title":"Statistics and Finch Evolution","tags":["Python","statistics","data analysis"]}}},"pageContext":{"slug":"/2018-02-12-FinchesStats/"}},"staticQueryHashes":["63159454"]}